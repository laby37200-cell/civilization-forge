# 제 7부: UI/UX 및 데이터

---

# 20장. UI/UX 설계

## 20.1. 화면 구성

### 20.1.1. 메인 화면 레이아웃

메인 화면은 다음과 같이 구성됩니다:

```
+--------------------------------------------------+
|  [상단 바]                                        |
|  턴 카운터 | 타이머 | 자원 표시 | 알림 | 설정    |
+--------------------------------------------------+
|                                                  |
|  [좌측 패널]        [중앙 맵]        [우측 패널]  |
|  - 도시 목록        - 육각형 타일    - 선택 정보  |
|  - 병력 목록        - 도시 표시      - 건물 정보  |
|  - 건물 목록        - 병력 표시      - 전투 정보  |
|                                                  |
+--------------------------------------------------+
|  [하단 바]                                        |
|  채팅 | 외교 | 거래 | 첩보 | 뉴스                |
+--------------------------------------------------+
```

### 20.1.2. 상단 바 상세

| 요소 | 설명 |
| :--- | :--- |
| **턴 카운터** | 현재 턴 번호 (T1, T2, T3...) |
| **타이머** | 현재 턴 남은 시간 (초 단위) |
| **자원 표시** | 병력, 돈, 식량, 특산물 현황 |
| **알림** | 중요 이벤트 알림 (공격, 거래 등) |
| **설정** | 게임 설정, 사운드, 그래픽 등 |

### 20.1.3. 좌측 패널 상세

| 요소 | 설명 |
| :--- | :--- |
| **도시 목록** | 보유 도시 목록, 클릭 시 해당 도시로 이동 |
| **병력 목록** | 보유 병력 목록, 병과별 분류 |
| **건물 목록** | 건설 중/완료 건물 목록 |

### 20.1.4. 우측 패널 상세

| 요소 | 설명 |
| :--- | :--- |
| **선택 정보** | 선택한 타일/도시/병력의 상세 정보 |
| **건물 정보** | 선택한 건물의 효과 및 상태 |
| **전투 정보** | 진행 중인 전투 정보 |

### 20.1.5. 하단 바 상세

| 요소 | 설명 |
| :--- | :--- |
| **채팅** | 1:1, 동맹, 전체 채팅 |
| **외교** | 외교 관계 관리, 동맹/선전포고 등 |
| **거래** | 거래 제안 및 관리 |
| **첩보** | 스파이 관리, 첩보 활동 |
| **뉴스** | 게임 내 주요 이벤트 뉴스 |

## 20.2. 맵 인터페이스

### 20.2.1. 타일 표시

| 상태 | 표시 |
| :--- | :--- |
| 아군 타일 | 파란색 테두리 |
| 적군 타일 | 빨간색 테두리 |
| 중립 타일 | 회색 테두리 |
| 동맹 타일 | 초록색 테두리 |
| 선택된 타일 | 노란색 하이라이트 |

### 20.2.2. 도시 표시

| 등급 | 아이콘 |
| :--- | :--- |
| 수도 | 왕관 아이콘 |
| 주요 도시 | 성 아이콘 |
| 일반 도시 | 집 아이콘 |
| 작은 마을 | 오두막 아이콘 |

### 20.2.3. 병력 표시

| 병과 | 아이콘 |
| :--- | :--- |
| 보병 | 검 아이콘 |
| 기병 | 말 아이콘 |
| 궁병 | 활 아이콘 |
| 공성병기 | 투석기 아이콘 |
| 해군 | 배 아이콘 |
| 첩보 | 눈 아이콘 (아군만 표시) |

## 20.3. 전투 인터페이스

### 20.3.1. 전투 화면 구성

```
+--------------------------------------------------+
|  [전투 정보 바]                                   |
|  공격자 vs 방어자 | 지형 | 남은 시간              |
+--------------------------------------------------+
|                                                  |
|  [공격자 정보]      [전투 맵]      [방어자 정보]  |
|  - 병력 구성        - 지형 표시    - 병력 구성    |
|  - 태세 선택        - 병력 배치    - 태세 선택    |
|  - 전략 입력        - 전투 진행    - 전략 입력    |
|                                                  |
+--------------------------------------------------+
|  [전략 입력창]                                    |
|  100자 이내로 세부 전략을 입력하세요...           |
+--------------------------------------------------+
```

### 20.3.2. 태세 선택 UI

| 공격 태세 | 방어 태세 |
| :--- | :--- |
| 정면 돌진 (Charge) | 견고한 방어 (Solid Defense) |
| 포위 (Encircle) | 유연한 대응 (Flexible) |
| 기습 (Ambush) | 반격 (Counter) |

### 20.3.3. 전투 결과 화면

전투가 종료되면 다음 정보가 표시됩니다:

| 항목 | 설명 |
| :--- | :--- |
| 승패 | 승리/패배/무승부 |
| 전략 점수 | 양측의 전략 점수 (0~30) |
| 병력 손실 | 양측의 병력 손실 |
| 약탈 | 약탈된 자원 (승자만) |
| LLM 판정 요약 | AI의 전략 평가 요약 |

## 20.4. 도시 관리 인터페이스

### 20.4.1. 도시 정보 화면

```
+--------------------------------------------------+
|  [도시명] - [등급]                                |
|  소유자: [플레이어명] | 국가: [국가명]            |
+--------------------------------------------------+
|  [자원 현황]                                      |
|  병력: 1,500 | 돈: 5,000 | 식량: 3,000           |
|  특산물: 쌀 (500) | 행복도: 75%                  |
+--------------------------------------------------+
|  [생산량]                                         |
|  병력: +15/턴 | 돈: +120/턴 | 식량: +90/턴       |
|  특산물: +10/턴                                   |
+--------------------------------------------------+
|  [건물 목록]                                      |
|  - 시장 (완료)                                    |
|  - 훈련소 (건설 중, 2턴 남음)                     |
|  - [빈 슬롯]                                      |
+--------------------------------------------------+
|  [타일 정보]                                      |
|  N: 평야, 농장 | NE: 숲 | SE: 언덕               |
|  S: 평야 | SW: 산악 | NW: 해안, 항구             |
+--------------------------------------------------+
```

### 20.4.2. 건설 메뉴

건설 가능한 건물 목록이 카테고리별로 표시됩니다:

| 카테고리 | 건물 목록 |
| :--- | :--- |
| 군사 시설 | 훈련소, 무기고, 성벽, 요새, 병참기지 |
| 경제 시설 | 농장, 시장, 조세청, 항구, 특산물 공방 |
| 정보/외교 시설 | 정찰소, 첩보 본부, 외교관저, 국제 무역소, 암호 해독국 |
| 국가/행복도 시설 | 대학, 공원/극장, 병원, 전략 사령부 |

### 20.4.3. 징집 메뉴

병력 징집 시 다음 정보가 표시됩니다:

| 항목 | 설명 |
| :--- | :--- |
| 현재 인구 | 도시의 현재 인구 |
| 현재 병력 | 도시의 현재 병력 |
| 안전 징집량 | 인구의 10% |
| 최대 징집량 | 인구의 50% |
| 징집 시 행복도 변화 | 징집량에 따른 행복도 감소 예상치 |

---

# 21장. 뉴스 시스템

## 21.1. 뉴스 시스템 개요

### 21.1.1. 설계 철학

뉴스 시스템은 게임 내 주요 이벤트를 플레이어에게 알리고, 몰입감을 높이는 역할을 합니다. LLM을 활용하여 자연스러운 뉴스 문체로 이벤트를 전달합니다.

### 21.1.2. 뉴스 유형

| 유형 | 설명 |
| :--- | :--- |
| **전투 뉴스** | 전투 발생 및 결과 |
| **외교 뉴스** | 동맹, 선전포고, 휴전 등 |
| **경제 뉴스** | 대규모 거래, 자원 변동 |
| **첩보 뉴스** | 스파이 발각, 첩보 활동 결과 |
| **도시 뉴스** | 도시 점령, 반란, 건물 완성 |

## 21.2. 뉴스 생성 규칙

### 21.2.1. 전투 뉴스 생성

전투가 발생하면 다음 정보를 기반으로 뉴스가 생성됩니다:

| 정보 | 예시 |
| :--- | :--- |
| 공격자 | 서울 (한국) |
| 방어자 | 도쿄 (일본) |
| 결과 | 공격자 승리 |
| 병력 손실 | 공격자 300, 방어자 500 |

**뉴스 예시**:
> **[속보] 서울군, 도쿄 북쪽 타일 점령!**
> 한국의 서울군이 일본의 도쿄 북쪽 타일을 점령했습니다. 이번 전투에서 서울군은 300명의 병력을 잃었으나, 도쿄군은 500명의 병력을 잃었습니다. 전문가들은 이번 승리가 한국의 동아시아 패권 확립에 중요한 전환점이 될 것으로 분석하고 있습니다.

### 21.2.2. 외교 뉴스 생성

외교 이벤트가 발생하면 다음 정보를 기반으로 뉴스가 생성됩니다:

| 정보 | 예시 |
| :--- | :--- |
| 이벤트 | 동맹 체결 |
| 당사자 | 한국, 일본 |

**뉴스 예시**:
> **[외교] 한국-일본 동맹 체결!**
> 한국과 일본이 공식적으로 동맹을 체결했습니다. 양국은 공동 방어와 경제 협력을 약속했으며, 이번 동맹이 동아시아 지역의 세력 균형에 큰 영향을 미칠 것으로 예상됩니다.

### 21.2.3. 첩보 뉴스 생성

첩보 활동 결과가 발생하면 다음 정보를 기반으로 뉴스가 생성됩니다:

| 정보 | 예시 |
| :--- | :--- |
| 이벤트 | 스파이 발각 |
| 대상 | 중국 스파이 |
| 장소 | 서울 |

**뉴스 예시**:
> **[첩보] 서울에서 중국 스파이 발각!**
> 서울 당국이 중국 스파이를 발각하여 체포했습니다. 해당 스파이는 서울의 군사 정보를 수집하던 중 발각된 것으로 알려졌습니다. 이번 사건으로 한중 관계에 긴장이 고조되고 있습니다.

## 21.3. 뉴스 공개 범위

### 21.3.1. 공개 범위 분류

| 뉴스 유형 | 공개 범위 |
| :--- | :--- |
| 전투 뉴스 | 전체 공개 |
| 외교 뉴스 | 전체 공개 |
| 경제 뉴스 (대규모) | 전체 공개 |
| 경제 뉴스 (소규모) | 당사자만 |
| 첩보 뉴스 | 당사자만 |
| 도시 뉴스 | 전체 공개 |

### 21.3.2. 첩보력에 따른 추가 정보

첩보력이 높은 플레이어는 뉴스에서 추가 정보를 얻을 수 있습니다:

| 첩보력 | 추가 정보 |
| :---: | :--- |
| 0~29 | 기본 정보만 |
| 30~59 | 병력 규모 대략적 파악 |
| 60~89 | 병력 구성 파악 |
| 90~100 | 전략 일부 파악 |

---

# 22장. AI 영주 시스템

## 22.1. AI 영주 개요

### 22.1.1. AI 영주 역할

AI 영주는 플레이어가 선택하지 않은 도시를 관리합니다. AI 영주는 난이도에 따라 다른 전략을 사용합니다.

### 22.1.2. AI 난이도별 특성

| 난이도 | 공격성 | 외교 | 경제 |
| :--- | :--- | :--- | :--- |
| **쉬움** | 수동적 | 우호적 | 비효율적 |
| **보통** | 균형 | 중립적 | 표준 |
| **어려움** | 공격적 | 기회주의적 | 효율적 |

## 22.2. AI 의사결정 시스템

### 22.2.1. 의사결정 우선순위

AI 영주는 매 턴 다음 순서로 의사결정을 수행합니다:

1. 방어 필요 여부 확인
2. 자원 상태 확인
3. 건설 필요 여부 확인
4. 공격 기회 확인
5. 외교 기회 확인

### 22.2.2. 방어 의사결정

| 상황 | AI 행동 |
| :--- | :--- |
| 적 병력 인접 | 방어 태세 강화, 병력 집결 |
| 행복도 낮음 | 세율 감소, 문화 건물 건설 |
| 식량 부족 | 농장 건설, 거래 시도 |

### 22.2.3. 공격 의사결정

| 상황 | AI 행동 |
| :--- | :--- |
| 적 병력 열세 | 공격 시도 |
| 중립 타일 인접 | 확장 시도 |
| 동맹 요청 | 상황에 따라 수락/거절 |

## 22.3. AI 전략 텍스트 생성

### 22.3.1. AI 전략 템플릿

AI 영주도 LLM 전투 판정을 위해 전략 텍스트를 생성합니다. 난이도에 따라 전략의 품질이 달라집니다.

**쉬움 난이도 예시**:
> "병력을 모아 정면으로 공격한다."

**보통 난이도 예시**:
> "보병을 전면에 배치하고, 궁병으로 후방 지원한다."

**어려움 난이도 예시**:
> "기병을 우측 숲에 매복시켜 적의 측면을 타격한다. 보병은 정면에서 적의 주의를 끌고, 궁병은 언덕에서 원거리 공격으로 지원한다."

---

# 23장. 데이터베이스 스키마

## 23.1. 마스터 데이터 테이블 (정적 데이터)

### 23.1.1. buildings 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 건물 ID (PK) |
| name | VARCHAR | 건물 이름 |
| category | VARCHAR | 카테고리 (군사/경제/정보/국가) |
| cost | INT | 건설 비용 |
| build_time | INT | 건설 시간 (턴) |
| effect | JSON | 효과 (보너스 목록) |
| restriction | VARCHAR | 건설 제한 조건 |

### 23.1.2. units 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 병과 ID (PK) |
| name | VARCHAR | 병과 이름 |
| mobility | INT | 기본 이동력 |
| attack | FLOAT | 공격력 계수 |
| defense | FLOAT | 방어력 계수 |
| upkeep | INT | 유지비 |
| requirement | VARCHAR | 필요 조건 |

### 23.1.3. specialties 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 특산물 ID (PK) |
| name | VARCHAR | 특산물 이름 |
| base_value | INT | 기본 가치 |
| effect | JSON | 보유 효과 |
| rarity | VARCHAR | 희귀도 |

### 23.1.4. countries 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 국가 ID (PK) |
| name | VARCHAR | 국가 이름 |
| capital_id | INT | 수도 도시 ID (FK) |
| continent | VARCHAR | 대륙 |

### 23.1.5. cities 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 도시 ID (PK) |
| name | VARCHAR | 도시 이름 |
| country_id | INT | 국가 ID (FK) |
| grade | VARCHAR | 등급 (수도/주요/일반/마을) |
| terrain | VARCHAR | 중심 타일 지형 |
| specialty_id | INT | 특산물 ID (FK) |
| init_troops | INT | 초기 병력 |
| init_gold | INT | 초기 돈 |
| init_food | INT | 초기 식량 |

## 23.2. 동적 데이터 테이블 (게임 진행 데이터)

### 23.2.1. game_sessions 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 방 ID (PK) |
| name | VARCHAR | 방 이름 |
| mode | VARCHAR | 게임 모드 |
| turn_time | INT | 턴 시간 (초) |
| current_turn | INT | 현재 턴 |
| status | VARCHAR | 상태 (대기/진행/종료) |
| created_at | DATETIME | 생성 시간 |
| updated_at | DATETIME | 마지막 업데이트 시간 |

### 23.2.2. players 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 플레이어 ID (PK) |
| session_id | INT | 방 ID (FK) |
| user_id | INT | 유저 계정 ID (FK) |
| country_id | INT | 소속 국가 ID (FK) |
| city_id | INT | 시작 도시 ID (FK) |
| status | VARCHAR | 상태 (활성/이탈/게임오버) |
| score | INT | 현재 점수 |

### 23.2.3. city_states 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 상태 ID (PK) |
| session_id | INT | 방 ID (FK) |
| city_id | INT | 도시 ID (FK) |
| owner_id | INT | 현재 소유자 ID (FK) |
| troops | INT | 현재 병력 |
| gold | INT | 현재 돈 |
| food | INT | 현재 식량 |
| specialty_amount | INT | 현재 특산물 양 |
| happiness | INT | 현재 행복도 |
| intelligence | INT | 현재 첩보력 |

### 23.2.4. troop_movements 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 이동 ID (PK) |
| session_id | INT | 방 ID (FK) |
| owner_id | INT | 소유자 ID (FK) |
| unit_type | VARCHAR | 병과 |
| count | INT | 병력 수 |
| from_tile | INT | 출발 타일 ID |
| to_tile | INT | 도착 타일 ID |
| remaining_turns | INT | 남은 턴 수 |

### 23.2.5. diplomacy_relations 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 관계 ID (PK) |
| session_id | INT | 방 ID (FK) |
| country1_id | INT | 국가1 ID (FK) |
| country2_id | INT | 국가2 ID (FK) |
| relation | VARCHAR | 관계 (동맹/우호/중립/적대/전쟁) |
| affinity | INT | 우호도 (0~100) |

### 23.2.6. battles 테이블

| 컬럼 | 타입 | 설명 |
| :--- | :--- | :--- |
| id | INT | 전투 ID (PK) |
| session_id | INT | 방 ID (FK) |
| attacker_id | INT | 공격자 ID (FK) |
| defender_id | INT | 방어자 ID (FK) |
| tile_id | INT | 전투 타일 ID |
| attacker_stance | VARCHAR | 공격자 태세 |
| defender_stance | VARCHAR | 방어자 태세 |
| attacker_tactic | TEXT | 공격자 전략 텍스트 |
| defender_tactic | TEXT | 방어자 전략 텍스트 |
| attacker_score | INT | 공격자 전략 점수 |
| defender_score | INT | 방어자 전략 점수 |
| result | VARCHAR | 결과 (공격승/방어승/무승부) |
| attacker_loss | INT | 공격자 손실 |
| defender_loss | INT | 방어자 손실 |
| turn | INT | 발생 턴 |

## 23.3. LLM API 연동 데이터 구조

### 23.3.1. 전투 판정 요청 JSON

```
{
  "battle_id": "unique_battle_id",
  "terrain": "Forest",
  "weather": "Clear",
  "attacker": {
    "player_id": "player1",
    "stance": "Ambush",
    "tactic_text": "기병을 우회시켜 적의 후방을 공격한다.",
    "units": [
      {"type": "Cavalry", "count": 500},
      {"type": "Infantry", "count": 500}
    ],
    "buildings": ["Armory", "Training_Ground"],
    "intelligence_level": 3,
    "happiness": 75
  },
  "defender": {
    "player_id": "player2",
    "stance": "Solid_Defense",
    "tactic_text": "숲의 이점을 활용해 궁병으로 원거리 공격에 집중한다.",
    "units": [
      {"type": "Archer", "count": 800}
    ],
    "buildings": ["Wall", "Fortress"],
    "intelligence_level": 2,
    "happiness": 80
  }
}
```

### 23.3.2. 전투 판정 응답 JSON

```
{
  "battle_id": "unique_battle_id",
  "attacker_strategy_score": 18,
  "defender_strategy_score": 22,
  "strategy_analysis": {
    "attacker": {
      "terrain_match": 6,
      "unit_synergy": 4,
      "tactical_logic": 8,
      "intel_counter": 0
    },
    "defender": {
      "terrain_match": 8,
      "unit_synergy": 4,
      "tactical_logic": 7,
      "intel_counter": 3
    }
  },
  "result": "defender_win",
  "attacker_loss_ratio": 0.45,
  "defender_loss_ratio": 0.25,
  "narrative": "공격자의 기습 전략은 숲 지형에서 효과적이었으나, 방어자가 미리 궁병을 배치하여 측면 공격을 저지했습니다."
}
```

---


---

