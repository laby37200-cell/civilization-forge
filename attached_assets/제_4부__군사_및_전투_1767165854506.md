# 제 4부: 군사 및 전투

---

# 11장. 병과 시스템

## 11.1. 병과 개요

### 11.1.1. 병과 시스템 설계 철학

본 게임의 병과 시스템은 복잡한 유닛 생산이 아닌, 징집된 병력에 장비/훈련을 입히는 추상화 방식을 사용합니다. 플레이어는 병력을 징집한 후, 해당 병력의 병과 비율을 설정하여 전투에 투입합니다.

### 11.1.2. 병과 목록

본 게임에는 6가지 병과가 존재합니다:

| 병과 | 역할 | 필요 조건 |
| :--- | :--- | :--- |
| **보병** | 범용 전투, 점령 | 없음 |
| **기병** | 기동전, 측면 공격 | 말 특산물 |
| **궁병** | 원거리 공격, 방어 | 없음 |
| **공성병기** | 건물 파괴, 공성전 | 무기/화약 특산물 |
| **해군** | 해상 이동, 해전 | 항구 건물 |
| **첩보** | 정보 수집, 공작 | 외교관저 건물 |

## 11.2. 병과별 상세 스탯

### 11.2.1. 보병 (Infantry)

보병은 가장 기본적인 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 3 |
| **공격력 계수** | 1.0 |
| **방어력 계수** | 1.2 |
| **유지비** | 100명당 식량 5 |
| **특수 능력** | 모든 지형에서 안정적, 점령 속도 +20% |
| **상성** | 궁병에게 강함, 기병에게 약함 |

### 11.2.2. 기병 (Cavalry)

기병은 기동력이 뛰어난 공격형 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 5 |
| **공격력 계수** | 1.5 |
| **방어력 계수** | 0.8 |
| **유지비** | 100명당 식량 8 |
| **필요 조건** | 말 특산물 보유 |
| **특수 능력** | 초원/평야에서 이동력 +30%, 공격력 +20% |
| **상성** | 보병에게 강함, 궁병에게 약함 |

### 11.2.3. 궁병 (Archer)

궁병은 원거리 공격에 특화된 방어형 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 3 |
| **공격력 계수** | 1.2 |
| **방어력 계수** | 0.7 |
| **유지비** | 100명당 식량 6 |
| **특수 능력** | 언덕/산악에서 사거리 및 공격력 +30% |
| **상성** | 기병에게 강함, 보병에게 약함 |

### 11.2.4. 공성병기 (Siege)

공성병기는 건물 파괴에 특화된 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 2 |
| **공격력 계수** | 2.0 (건물 대상) |
| **방어력 계수** | 0.5 |
| **유지비** | 100명당 식량 10 |
| **필요 조건** | 무기/화약 특산물 보유 |
| **특수 능력** | 건물 파괴 확률 +50% |
| **제한** | 산악 지형 진입 불가 |

### 11.2.5. 해군 (Navy)

해군은 해상 전투와 이동에 특화된 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 3 (해상) |
| **공격력 계수** | 1.5 (해상) |
| **방어력 계수** | 1.5 (해상) |
| **유지비** | 100명당 식량 12 |
| **필요 조건** | 항구 건물 보유 |
| **특수 능력** | 해상 이동 가능, 해안 포격 가능 |
| **제한** | 육지 전투 불가 |

### 11.2.6. 첩보 (Spy)

첩보는 정보 수집과 공작에 특화된 특수 병과입니다.

| 항목 | 수치 |
| :--- | :--- |
| **기본 이동력** | 4 |
| **공격력 계수** | 0.0 |
| **방어력 계수** | 0.0 |
| **유지비** | 1명당 돈 50 |
| **필요 조건** | 외교관저 건물 보유 |
| **특수 능력** | 적에게 보이지 않음, 첩보 활동 수행 |
| **제한** | 전투 불가, 발각 시 즉시 사망 |

## 11.3. 병과 상성 시스템

### 11.3.1. 상성 관계

```
보병 → 궁병 → 기병 → 보병 (가위바위보 구조)
```

| 공격 병과 | 유리한 상대 | 불리한 상대 |
| :--- | :--- | :--- |
| 보병 | 궁병 (+20% 데미지) | 기병 (-20% 데미지) |
| 기병 | 보병 (+20% 데미지) | 궁병 (-20% 데미지) |
| 궁병 | 기병 (+20% 데미지) | 보병 (-20% 데미지) |
| 공성병기 | 건물 (+100% 데미지) | 모든 병과 (-30% 데미지) |
| 해군 | 해상 전투 (+50%) | 육상 전투 (불가) |

### 11.3.2. 상성 적용 예시

기병 500명이 보병 500명을 공격하는 경우:

```
기본 공격력: 500 × 1.5 = 750
상성 보너스: 750 × 1.2 = 900 (보병에게 +20%)
최종 공격력: 900
```

## 11.4. 병력 이동 시스템

### 11.4.1. 기본 이동력

| 병과 | 기본 이동력 |
| :--- | :---: |
| 보병 | 3 |
| 기병 | 5 |
| 궁병 | 3 |
| 공성병기 | 2 |
| 해군 | 3 (해상) |
| 첩보 | 4 |

### 11.4.2. 이동력 보너스

| 요인 | 이동력 변화 |
| :--- | :---: |
| 도로/철도 타일 통과 | 소모 -1 (최소 0.5) |
| 전략 사령부 건물 | 국가 전체 +1 |
| 말 특산물 (기병) | +1 |
| 병참기지 타일 시작 | +1 |

### 11.4.3. 지형별 이동 비용

| 지형 | 이동 비용 |
| :--- | :---: |
| 평야 | 1.0 |
| 초원 | 0.7 |
| 산악 | 2.0 |
| 언덕 | 1.5 |
| 숲 | 1.2 |
| 산림 | 2.0 |
| 사막 | 1.3 |
| 바다 | 1.0 (해군만) |

### 11.4.4. 해상 이동

항구가 있는 도시에서만 바다 타일로 진입할 수 있습니다. 모든 인력(병력, 첩보)은 항구가 개방될 때까지 바다에서 이동이 불가능합니다.

---

# 12장. 전투 시스템

## 12.1. 전투 개요

### 12.1.1. 전투 시스템 설계 철학

본 게임의 전투 시스템은 **순수 LLM 텍스트 판정 방식**을 채택합니다. 플레이어는 정해진 프리셋이나 태세 선택 없이, **자유로운 텍스트로 전략을 직접 작성**합니다. LLM은 이 전략을 분석하여 전략 점수를 부여하고, 이 점수가 전투 결과에 반영됩니다. 전략을 입력하지 않은 경우 **전략 점수 0점**으로 처리되어 능력치만으로 전투가 진행됩니다.

### 12.1.2. 전투력 구성 비율

전투력은 다음 비율로 구성됩니다:

| 요소 | 비중 |
| :--- | :---: |
| **능력치 점수** | 70% |
| **전략 점수** | 30% |

## 12.2. 전투 프로세스

### 12.2.1. 전투 4단계 프로세스

**[1단계] 공격 선언**

공격자가 대상 타일을 지정하고 병력을 투입합니다.

```
공격 선언 예시:
- 공격 도시: 서울
- 목표 타일: 도쿄 북쪽 타일
- 투입 병력: 1,000명 (보병 500, 기병 300, 궁병 200)
```

**[2단계] 방어 준비**

방어자에게 공격 알림이 전송됩니다. 방어자는 해당 턴 내에 방어 전략을 수립해야 합니다.

```
방어 알림 예시:
"서울이 당신의 도쿄 북쪽 타일을 공격하려고 합니다!"
- 예상 공격 병력: 약 1,000명 (첩보력에 따라 정확도 다름)
- 방어 준비 시간: 현재 턴 종료까지
```

**[3단계] 전략 입력**

공격자와 방어자가 동시에 전략을 입력합니다.

**[4단계] 판정 및 결과**

LLM이 양측의 전략을 분석하고 전투 결과를 판정합니다.

### 12.2.2. 전략 입력 시스템

전략 입력은 **자유 텍스트 방식**으로 진행됩니다. 태세 선택이나 프리셋 없이, 플레이어가 직접 전략을 작성합니다.

**전략 텍스트 입력 규칙**

| 항목 | 규칙 |
| :--- | :--- |
| 글자 수 | 200자 이내 |
| 입력 시간 | 턴 종료 전까지 |
| 미입력 시 | **전략 점수 0점** 처리 |
| 언어 | 한국어/영어 모두 가능 |

**전략 텍스트 작성 가이드**

좋은 전략 텍스트는 다음 요소를 포함해야 합니다:

| 요소 | 설명 | 예시 |
| :--- | :--- | :--- |
| **지형 활용** | 전투 타일의 지형을 어떻게 활용할 것인가 | "숲의 엄폐물을 활용하여..." |
| **병과 배치** | 각 병과를 어디에 어떻게 배치할 것인가 | "기병은 우측 측면에, 궁병은 후방 언덕에..." |
| **전술 목표** | 무엇을 달성하려고 하는가 | "적의 보급로를 차단하여..." |
| **상황 대응** | 예상되는 적의 행동에 어떻게 대응할 것인가 | "적이 측면 공격 시 예비대로 대응..." |

**공격자 전략 예시**

```
"기병 300을 우측 숲에 매복시키고, 보병 500으로 정면에서 적의 주의를 끈다.
적이 정면에 집중하면 기병이 측면을 타격하고, 궁병 200은 후방 언덕에서 지원 사격한다.
목표는 적의 지휘부를 혼란에 빠뜨려 조직적 방어를 무력화하는 것이다."
```

**방어자 전략 예시**

```
"성벽 위에 궁병 400을 배치하여 접근하는 적에게 원거리 공격을 집중한다.
보병 300은 성문 앞에서 적의 돌파를 저지하고, 기병 200은 예비대로 측면 기습에 대비한다.
첩보에 따르면 적이 기습을 준비 중이므로, 숲 방향에 정찰병을 배치한다."
```

**미입력 시 처리**

전략 텍스트를 입력하지 않으면 **전략 점수 0점**으로 처리됩니다. 이 경우 능력치 점수만으로 전투가 진행되며, 상대가 전략을 입력했다면 최대 30%의 불이익을 받게 됩니다.

## 12.3. 전투력 계산

### 12.3.1. 능력치 점수 (70%)

능력치 점수는 다음 공식으로 계산됩니다:

```
능력치 점수 = 병력수 × 병과계수 × (1 + 건물보너스) × (1 + 지형보너스) × (1 + 상성보너스) × 행복도배율
```

**공격력 계산 예시**

서울(공격자)이 도쿄(방어자)를 공격하는 경우:

```
병력: 1,000명 (보병)
병과 계수: 1.0
건물 보너스: 무기고 +20% = 0.2
지형 보너스: 평야 +20% = 0.2
상성 보너스: 없음 = 0
행복도: 70% → 배율 1.0

능력치 점수 = 1,000 × 1.0 × (1 + 0.2) × (1 + 0.2) × (1 + 0) × 1.0
            = 1,000 × 1.0 × 1.2 × 1.2 × 1.0 × 1.0
            = 1,440
```

### 12.3.2. 전략 점수 (30%)

전략 점수는 LLM이 부여하는 0~30점 사이의 점수입니다.

**전략 점수 평가 기준**

| 평가 항목 | 배점 | 상세 판정 기준 |
| :--- | :---: | :--- |
| **지형 일치성** | 10점 | 전략이 현재 전투 타일의 지형을 효과적으로 활용하는가? |
| **병과 연계성** | 5점 | 투입된 병력의 병과와 전략이 논리적으로 연결되는가? |
| **병법 논리성** | 10점 | 포위, 기습, 보급로 차단 등 실제 병법의 원리가 적용되었는가? |
| **첩보 카운터** | 5점 | (방어자 한정) 첩보를 통해 얻은 상대 전략에 대한 직접적인 대응을 제시했는가? |

**전략 점수 적용**

전략 점수는 다음과 같이 전투력에 반영됩니다:

```
전투력 보정 계수 = 1 + (전략 점수 / 100)
```

전략 점수 30점 만점 시, 전투력에 1.3배(30%) 가중치가 부여됩니다.

### 12.3.3. 최종 전투력 계산

```
최종 전투력 = 능력치 점수 × 전투력 보정 계수
```

**계산 예시**

```
능력치 점수: 1,440
전략 점수: 20점 → 보정 계수 1.2

최종 전투력 = 1,440 × 1.2 = 1,728
```

## 12.4. 전투 결과 판정

### 12.4.1. 승패 판정

양측의 최종 전투력을 비교하여 승패를 판정합니다.

```
승률 = 공격자 전투력 / (공격자 전투력 + 방어자 전투력) × 100
최종 승률 = 기본 승률 ± 무작위 요소(±10%)
```

### 12.4.2. 병력 손실 계산

전투력 차이에 따라 병력 손실이 결정됩니다.

| 전투력 차이 | 승자 손실 | 패자 손실 |
| :--- | :---: | :---: |
| 압도적 승리 (2배 이상) | 10~20% | 80~100% |
| 대승 (1.5~2배) | 20~30% | 60~80% |
| 신승 (1.2~1.5배) | 30~40% | 50~60% |
| 박빙 (1~1.2배) | 40~50% | 50~60% |

### 12.4.3. 타일 점령 조건

타일을 점령하려면 다음 조건을 충족해야 합니다:

| 조건 | 설명 |
| :--- | :--- |
| **적 병력 0명** | 해당 타일의 적 병력이 모두 제거됨 |
| **아군 병력 100명 이상** | 해당 타일에 아군 병력 100명 이상 진입 |

### 12.4.4. 도시 점령

도시 중앙 타일(궁전/시청)을 점령하면 해당 도시의 소유권이 이전됩니다. 도시를 점령하면 해당 도시가 소유한 모든 타일도 함께 점령됩니다.

### 12.4.5. 약탈

타일 점령 시 다음과 같은 약탈이 발생합니다:

| 항목 | 약탈량 |
| :--- | :--- |
| 돈 | 20~30% |
| 특산물 | 10~20% |
| 건물 파괴 | 20% 확률 |

---

# 13장. LLM 전투 판정 상세

## 13.1. LLM 판정 프로세스

### 13.1.1. 판정 흐름

```
1. 양측 전략 텍스트 수집
2. 전투 컨텍스트 구성 (지형, 병력, 건물 등)
3. LLM API 호출
4. 전략 점수 산출
5. 전투 결과 계산
6. 결과 뉴스 생성
```

### 13.1.2. LLM API 호출 데이터 구조

LLM API 호출 시 다음과 같은 JSON 형식의 데이터를 전송합니다:

```
{
  "battle_id": "unique_battle_id",
  "terrain": "Forest",
  "weather": "Clear",
  "attacker": {
    "player_id": "player1",
    "strategy_text": "기병 300을 우측 숲에 매복시키고, 보병 500으로 정면에서 적의 주의를 끈다. 적이 정면에 집중하면 기병이 측면을 타격한다.",
    "units": [
      {"type": "Cavalry", "count": 300},
      {"type": "Infantry", "count": 500},
      {"type": "Archer", "count": 200}
    ],
    "buildings": ["Armory", "Training_Ground"],
    "intelligence_level": 3,
    "happiness": 75
  },
  "defender": {
    "player_id": "player2",
    "strategy_text": "성벽 위에 궁병을 배치하여 원거리 공격에 집중한다. 보병은 성문 앞에서 적의 돌파를 저지한다.",
    "units": [
      {"type": "Archer", "count": 400},
      {"type": "Infantry", "count": 300},
      {"type": "Cavalry", "count": 200}
    ],
    "buildings": ["Wall", "Fortress"],
    "intelligence_level": 2,
    "happiness": 80
  }
}
```

**전략 미입력 시 데이터 구조**

전략을 입력하지 않은 경우, `strategy_text` 필드가 빈 문자열로 전송되고 해당 플레이어의 전략 점수는 **0점**으로 처리됩니다.

```
{
  "attacker": {
    "strategy_text": "",  // 미입력 시 빈 문자열
    ...
  }
}
```

## 13.2. 전략 점수 산출 상세

### 13.2.1. 지형 일치성 (10점)

| 점수 | 기준 |
| :---: | :--- |
| 10점 | 지형을 완벽하게 활용한 전략 (숲에서 매복, 산악에서 고지 점령 등) |
| 7점 | 지형을 적절히 활용한 전략 |
| 4점 | 지형을 고려했으나 활용이 미흡한 전략 |
| 1점 | 지형을 무시한 전략 |
| 0점 | 지형에 반하는 전략 (사막에서 기병 돌격 등) |

### 13.2.2. 병과 연계성 (5점)

| 점수 | 기준 |
| :---: | :--- |
| 5점 | 병과 특성을 완벽하게 활용한 전략 |
| 3점 | 병과 특성을 적절히 활용한 전략 |
| 1점 | 병과 특성을 고려하지 않은 전략 |
| 0점 | 병과 특성에 반하는 전략 (궁병으로 돌격 등) |

### 13.2.3. 병법 논리성 (10점)

| 점수 | 기준 |
| :---: | :--- |
| 10점 | 고급 병법 원리 적용 (포위, 분산, 집중, 기만 등) |
| 7점 | 기본 병법 원리 적용 |
| 4점 | 논리적이나 평범한 전략 |
| 1점 | 비논리적인 전략 |
| 0점 | 실행 불가능한 전략 |

### 13.2.4. 첩보 카운터 (5점, 방어자 한정)

| 점수 | 기준 |
| :---: | :--- |
| 5점 | 첩보로 얻은 정보를 완벽하게 활용한 대응 |
| 3점 | 첩보 정보를 적절히 활용한 대응 |
| 1점 | 첩보 정보를 언급했으나 활용이 미흡 |
| 0점 | 첩보 정보를 활용하지 않음 |

## 13.3. LLM 최적화

### 13.3.1. 소규모 전투 처리

LLM API 호출 비용과 지연을 줄이기 위해, 소규모 전투는 단순 수치 계산으로 처리합니다.

| 전투 규모 | 처리 방식 |
| :--- | :--- |
| 500명 미만 | 단순 수치 계산 (전략 점수 고정 15점) |
| 500명 이상 | LLM 판정 |

### 13.3.2. 캐싱

유사한 전략 텍스트에 대해서는 캐싱을 적용하여 API 호출을 줄입니다.

---

# 14장. 점령 및 약탈 시스템

## 14.1. 타일 점령

### 14.1.1. 점령 조건

타일을 점령하려면 다음 조건을 모두 충족해야 합니다:

| 조건 | 설명 |
| :--- | :--- |
| 적 병력 0명 | 해당 타일의 적 병력이 모두 제거됨 |
| 아군 병력 100명 이상 | 해당 타일에 아군 병력 100명 이상 진입 |
| 인접 타일 확보 | 점령하려는 타일과 인접한 아군 타일이 1개 이상 |

### 14.1.2. 점령 처리

타일 점령 시 다음과 같이 처리됩니다:

| 항목 | 처리 |
| :--- | :--- |
| 소유권 | 공격자로 이전 |
| 건물 | 유지 (파괴되지 않은 경우) |
| 자원 | 약탈 후 남은 자원 이전 |

## 14.2. 도시 점령

### 14.2.1. 도시 점령 조건

도시를 점령하려면 도시 중앙 타일(궁전/시청)을 점령해야 합니다.

### 14.2.2. 도시 점령 시 처리

도시 점령 시 다음과 같이 처리됩니다:

| 항목 | 처리 |
| :--- | :--- |
| 도시 소유권 | 공격자로 이전 |
| 도시 소속 타일 | 모두 공격자로 이전 |
| 건물 | 유지 (파괴되지 않은 경우) |
| 자원 | 약탈 후 남은 자원 이전 |
| 인구 | 유지 (행복도 -20%) |

### 14.2.3. 수도 점령 시 특수 처리

수도를 점령하면 다음과 같은 특수 처리가 적용됩니다:

| 항목 | 처리 |
| :--- | :--- |
| 수도 전용 건물 | 파괴 (전략 사령부, 첩보 본부) |
| 국가 버프 | 해제 (전략 사령부 이동력 보너스 등) |
| 새 수도 | 해당 국가의 최고 City Score 주요 도시로 이전 |

## 14.3. 약탈 시스템

### 14.3.1. 약탈 발생 조건

약탈은 다음 상황에서 발생합니다:

| 상황 | 약탈 발생 |
| :--- | :--- |
| 타일 점령 | 발생 |
| 도시 점령 | 발생 (더 많은 양) |
| 전투 승리 (점령 없음) | 발생하지 않음 |

### 14.3.2. 약탈량

| 항목 | 타일 점령 시 | 도시 점령 시 |
| :--- | :---: | :---: |
| 돈 | 20~30% | 30~50% |
| 식량 | 10~20% | 20~30% |
| 특산물 | 10~20% | 20~40% |
| 건물 파괴 | 20% 확률 | 30% 확률 |

### 14.3.3. 약탈 방지

다음 조건에서는 약탈이 감소합니다:

| 조건 | 약탈 감소 |
| :--- | :---: |
| 동맹 도시 점령 | -50% |
| 항복 수락 | -80% |
| 외교 협정 | -30% |

---


